#!/usr/bin/env perl
use warnings;
use strict;
use FindBin qw($Bin);
use lib "$Bin/../lib";
use Unicoder::Search qw(unicoder_load_db unicoder_search_db);
use Unicoder::Utils qw(u get_charnames print_char);
binmode(STDOUT, ":utf8");

our $all = 0;

use Getopt::Long;
Getopt::Long::Configure(qw(gnu_getopt));
Getopt::Long::GetOptions(
    'all' => \$all,
) or die(":-(\n");

unicoder_load_db();

my @results = unicoder_search_db(\@ARGV, 1);
my $result_count = @results;
splice(@results, 20);

foreach my $result (@results) {
    my ($codepoint, $score) = ($result->{codepoint},
                               $result->{score});
    my @charnames = get_charnames($codepoint);
    printf("%-8s  %6.2f  %s   %s\n", u($codepoint), $score, print_char($codepoint), $charnames[0]);
}
if ($result_count > 20) {
    printf("# Use --all to list all %d results.\n", $result_count);
}
