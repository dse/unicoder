#!/usr/bin/env perl
use warnings;
use strict;
use File::Basename qw(dirname);
use Unicode::UCD qw(prop_invlist);

use lib dirname(__FILE__) . "/../lib";
use Unicoder::Utils qw(output_char);

STDOUT->binmode(":utf8");

my $key;
my $value;

if (scalar @ARGV == 1 && $ARGV[0] =~ /=/) {
    ($key, $value) = ($`, $');
} elsif (scalar @ARGV == 2) {
    ($key, $value) = @ARGV;
} else {
    die("invalid arguments\n");
}

my @invlist = prop_invlist("${key}=${value}");
if (scalar(@invlist) % 2 == 1) {
    push(@invlist, 1114112);
}
for (my $i = 0; $i < scalar @invlist; $i += 2) {
    my $start = $invlist[$i];
    my $end = $invlist[$i + 1];
    for (my $codepoint = $start; $codepoint < $end; $codepoint += 1) {
        print(output_char($codepoint, char => 1, property => $key));
    }
}
